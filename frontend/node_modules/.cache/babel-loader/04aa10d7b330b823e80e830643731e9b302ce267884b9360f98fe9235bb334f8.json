{"ast":null,"code":"var _jsxFileName = \"C:\\\\vscProjekti\\\\spletno\\\\AtmoTracker\\\\frontend\\\\src\\\\components\\\\WebSocketMap.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// Fix the default icon issue with Leaflet in React\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png',\n  iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png'\n});\nconst WebSocketMap = () => {\n  _s();\n  const [data, setData] = useState([]);\n  useEffect(() => {\n    const socket = new WebSocket('ws://localhost:3002');\n    socket.onopen = () => {\n      console.log('Connected to WebSocket server');\n    };\n    socket.onmessage = event => {\n      const receivedData = JSON.parse(event.data);\n      console.log('Received data:', receivedData);\n      setData(receivedData);\n    };\n    socket.onclose = () => {\n      console.log('Disconnected from WebSocket server');\n    };\n    socket.onerror = error => {\n      console.error('WebSocket error:', error);\n    };\n    return () => {\n      socket.close();\n    };\n  }, []);\n  const updateMap = data => {\n    return data.map((item, index) => {\n      const {\n        latitude,\n        longitude\n      } = item.data_series_id.location;\n      let popupContent = `<strong>${item.data_series_id.name}</strong><br>No relevant data available.`;\n      if (item.data_series_id.name.startsWith('Weather')) {\n        popupContent = `\n          <strong>${item.data_series_id.name}</strong><br>\n          Wind Speed: ${item.data.windSpeed || 'N/A'}<br>\n          Wind Gusts: ${item.data.windGusts || 'N/A'}<br>\n          Precipitation: ${item.data.precipitation || 'N/A'}\n        `;\n      } else if (item.data_series_id.name.startsWith('AirQuality')) {\n        popupContent = `\n          <strong>${item.data_series_id.name}</strong><br>\n          PM10: ${item.data.pm10 || 'N/A'}<br>\n          PM2.5: ${item.data.pm25 || 'N/A'}<br>\n          Ozone: ${item.data.ozon || 'N/A'}<br>\n          NO2: ${item.data.no2 || 'N/A'}\n        `;\n      }\n      return /*#__PURE__*/_jsxDEV(Marker, {\n        position: [latitude, longitude],\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            dangerouslySetInnerHTML: {\n              __html: popupContent\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [46.11929097137821, 14.756128960803503],\n      zoom: 8,\n      style: {\n        height: '600px',\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n        attribution: \"\\xA9 OpenStreetMap contributors\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), updateMap(data)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"dataDisplay\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Received Data\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n        id: \"dataOutput\",\n        children: JSON.stringify(data, null, 2)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n};\n_s(WebSocketMap, \"IEMTtLVFIuToo7X/raQbJAxzNQU=\");\n_c = WebSocketMap;\nexport default WebSocketMap;\nvar _c;\n$RefreshReg$(_c, \"WebSocketMap\");","map":{"version":3,"names":["React","useEffect","useState","MapContainer","TileLayer","Marker","Popup","L","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","WebSocketMap","_s","data","setData","socket","WebSocket","onopen","console","log","onmessage","event","receivedData","JSON","parse","onclose","onerror","error","close","updateMap","map","item","index","latitude","longitude","data_series_id","location","popupContent","name","startsWith","windSpeed","windGusts","precipitation","pm10","pm25","ozon","no2","position","children","dangerouslySetInnerHTML","__html","fileName","_jsxFileName","lineNumber","columnNumber","center","zoom","style","height","width","url","attribution","id","stringify","_c","$RefreshReg$"],"sources":["C:/vscProjekti/spletno/AtmoTracker/frontend/src/components/WebSocketMap.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\n// Fix the default icon issue with Leaflet in React\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png',\r\n  iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',\r\n  shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png'\r\n});\r\n\r\nconst WebSocketMap = () => {\r\n  const [data, setData] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const socket = new WebSocket('ws://localhost:3002');\r\n\r\n    socket.onopen = () => {\r\n      console.log('Connected to WebSocket server');\r\n    };\r\n\r\n    socket.onmessage = (event) => {\r\n      const receivedData = JSON.parse(event.data);\r\n      console.log('Received data:', receivedData);\r\n      setData(receivedData);\r\n    };\r\n\r\n    socket.onclose = () => {\r\n      console.log('Disconnected from WebSocket server');\r\n    };\r\n\r\n    socket.onerror = (error) => {\r\n      console.error('WebSocket error:', error);\r\n    };\r\n\r\n    return () => {\r\n      socket.close();\r\n    };\r\n  }, []);\r\n\r\n  const updateMap = (data) => {\r\n    return data.map((item, index) => {\r\n      const { latitude, longitude } = item.data_series_id.location;\r\n      let popupContent = `<strong>${item.data_series_id.name}</strong><br>No relevant data available.`;\r\n\r\n      if (item.data_series_id.name.startsWith('Weather')) {\r\n        popupContent = `\r\n          <strong>${item.data_series_id.name}</strong><br>\r\n          Wind Speed: ${item.data.windSpeed || 'N/A'}<br>\r\n          Wind Gusts: ${item.data.windGusts || 'N/A'}<br>\r\n          Precipitation: ${item.data.precipitation || 'N/A'}\r\n        `;\r\n      } else if (item.data_series_id.name.startsWith('AirQuality')) {\r\n        popupContent = `\r\n          <strong>${item.data_series_id.name}</strong><br>\r\n          PM10: ${item.data.pm10 || 'N/A'}<br>\r\n          PM2.5: ${item.data.pm25 || 'N/A'}<br>\r\n          Ozone: ${item.data.ozon || 'N/A'}<br>\r\n          NO2: ${item.data.no2 || 'N/A'}\r\n        `;\r\n      }\r\n\r\n      return (\r\n        <Marker key={index} position={[latitude, longitude]}>\r\n          <Popup>\r\n            <div dangerouslySetInnerHTML={{ __html: popupContent }} />\r\n          </Popup>\r\n        </Marker>\r\n      );\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <MapContainer center={[46.11929097137821, 14.756128960803503]} zoom={8} style={{ height: '600px', width: '100%' }}>\r\n        <TileLayer\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          attribution=\"Â© OpenStreetMap contributors\"\r\n        />\r\n        {updateMap(data)}\r\n      </MapContainer>\r\n      <div id=\"dataDisplay\">\r\n        <h2>Received Data</h2>\r\n        <pre id=\"dataOutput\">{JSON.stringify(data, null, 2)}</pre>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WebSocketMap;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}